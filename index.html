<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js ie ie6 lt-ie7 lt-ie8 lt-ie9 lt-ie10"><![endif]-->
<!--[if IE 7]>   <html class="no-js ie ie7 lt-ie8 lt-ie9 lt-ie10"><![endif]-->
<!--[if IE 8]>   <html class="no-js ie ie8 lt-ie9 lt-ie10"><![endif]-->
<!--[if IE 9]>   <html class="no-js ie ie9 lt-ie10"><![endif]-->
<!--[if gt IE 9]><html class="no-js ie ie10"><![endif]-->
<!--[if !IE]><!-->
<html class="no-js">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <title>cocowrite</title>
    <link type="text/css" rel="stylesheet" href="/css/landing-main.css"/>
    <link type="text/css" rel="stylesheet" href="/css/colorbox.css"/>

    <!--[if IE]><link type="text/css" rel="stylesheet" href="css/groundwork-ie.css"><![endif]-->
    <script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/js/dropzone.min.js"></script>
    <script type="text/javascript" src="/js/jquery.colorbox-min.js"></script>
  </head>
  <body>
    <div class="hero">
      <div class="logo logo-container">cocowrite</div>
      <p>You focus on the content, let cocowrite to
      figure out the typography.</p>
      <p>Two steps to generate stylished pdf document from your
      markdown file. <em>Try it now!</em></p>
    </div>
    
    <div class="row generator">
      <div class="one half">
	<div class="headline"><div class="order">1</div><h2 style="line-height:
	3em">Choose a template</h2></div>
	<div class="row">
	  <div class="two fifth template current" data-template="template1">
	    <img src="/images/template1.png"><br/><br/>
	    <a href="http://www.local.xxx:8888/template1.pdf">see sample</a>
	  </div>
	  <div class="two fifth template" data-template="template2">
	    <img src="/images/template2.png"><br/><br/>
	    <a href="http://www.local.xxx:8888/template2.pdf">see sample</a>
	  </div>
	  <div id="more_template" class="one fifth">
	    <a class="more" href="#">more templates</a>
	  </div>
	</div>
      </div>
      <div class="one half border-left" style="padding-left:3em">
	<div class="headline"><div class="order">2</div><h2>Drag your
	markdown file to the box below to generate a pdf
	document</h2></div>

	<div id="dropzone" class="dropzone">
	</div>
	<small style="padding-left:3em;">* Checkout the supported markdown
	syntax <a href="http://johnmacfarlane.net/pandoc/README.html#pandocs-markdown">here</a>. Notice
	that images are not supported yet.</small>
      </div>
    </div>

    <div id="more_content" style="display:none">
      <h1>More templates are coming </h1>
      <h2>Please leave your email to be notified as soon as they are available</h2>
      <div class="row" style="padding-top: 3em">
	<div class="three fourths pad-right"><input id="email" name="email"
	class="large" placeholder="you@example.com"/></div>
	<div class="one fourths"><button id="submit_email" class="blue large">submit</button></div>
      </div>
    </div>

    <script type="text/javascript">
      var api_root = "http://www.local.xxx:9000";
      
      function getURL() {
	  return api_root + "/documents?template=" + $('.template.current').data('template');
      }
      
      Dropzone.autoDiscover = false;
      Dropzone.options.dropzone = {
	  paramName: "file", 
	  maxFilesize: 2,
	  uploadMultiple: false,
	  dictDefaultMessage: "Drop your markdown file here"
      };
      var dz = new Dropzone("div.dropzone", { url: getURL() });
      var previous;
      dz.on("sending", function(file) {
	  previous = $("#dropzone").html();
	  $("#dropzone").html("<img class='spinner' src='/images/spinner.gif'/>");
      });

      dz.on("complete", function(file) {
	  $("#dropzone").html(previous);
      });
      dz.on("success", function(file,response) {
	  document.getElementById("downloader").src = response.pdf;
      });
      dz.on("error", function(file,error) {
	  alert("Oops! There is some error happened on our side. Make sure you upload a markdown file, or wait some time to try again.")
      });
      
      $('.template').on('click', function() {
	  $(this).siblings().removeClass('current');
	  $(this).addClass('current');
	  dz.options.url = getURL();
	  console.log(dz.options)
      });
      
      $('#more_template').on('click', function() {
	  $.colorbox({html: $('#more_content').html(), transition: "none", width: "640px", height: "400px", opacity: 0, onComplete: function() {
	      $('#cboxContent #submit_email').on('click', function() {
		  $.post(api_root + "/documents/interest", {email: $('#cboxContent #email').val()}).always(function() {
		      $.colorbox.close();
		  });
	      })
	      
	  }});
      });
      
     
    </script>
    <iframe id="downloader" style="display:none"/>
  </body>
</html>
